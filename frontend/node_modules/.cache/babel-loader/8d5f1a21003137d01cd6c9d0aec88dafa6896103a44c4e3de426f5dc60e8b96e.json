{"ast":null,"code":"import _objectSpread from\"C:/Users/JRoidl/Desktop/mitarbeiterapp/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// frontend/src/pages/staff/MyMessages.js\nimport React,{useState,useEffect}from'react';import api from'../../services/api';import toast from'react-hot-toast';import{EnvelopeIcon,EnvelopeOpenIcon,ExclamationCircleIcon,TrashIcon,ArrowLeftIcon,UserCircleIcon,ClockIcon,FunnelIcon,MagnifyingGlassIcon,XMarkIcon}from'@heroicons/react/24/outline';import{format,parseISO,formatDistanceToNow}from'date-fns';import{de}from'date-fns/locale';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MyMessages=()=>{const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[selectedMessage,setSelectedMessage]=useState(null);const[showDetails,setShowDetails]=useState(false);const[filter,setFilter]=useState('all');// all, unread, high\nconst[searchTerm,setSearchTerm]=useState('');const[stats,setStats]=useState({unread:0,total_received:0,unread_high_priority:0});const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(1);useEffect(()=>{loadMessages();loadStats();},[currentPage,filter]);const loadMessages=async()=>{try{setLoading(true);const params={page:currentPage,limit:20};if(filter==='unread'){params.unread=true;}const response=await api.get('/messages/',{params});setMessages(response.data.messages);setTotalPages(response.data.pagination.pages);}catch(error){console.error('Fehler beim Laden der Nachrichten:',error);toast.error('Fehler beim Laden der Nachrichten');}finally{setLoading(false);}};const loadStats=async()=>{try{const response=await api.get('/messages/stats');setStats(response.data);}catch(error){console.error('Fehler beim Laden der Statistiken:',error);}};const viewMessage=async message=>{setSelectedMessage(message);setShowDetails(true);// Markiere als gelesen wenn ungelesen\nif(!message.is_read){try{await api.patch(\"/messages/\".concat(message.id,\"/read\"));// Update lokalen State\nsetMessages(prev=>prev.map(msg=>msg.id===message.id?_objectSpread(_objectSpread({},msg),{},{is_read:true,read_at:new Date().toISOString()}):msg));// Update Stats\nsetStats(prev=>_objectSpread(_objectSpread({},prev),{},{unread:Math.max(0,prev.unread-1),unread_high_priority:message.priority==='high'?Math.max(0,prev.unread_high_priority-1):prev.unread_high_priority}));}catch(error){console.error('Fehler beim Markieren als gelesen:',error);}}};const markAsUnread=async messageId=>{try{await api.patch(\"/messages/\".concat(messageId,\"/unread\"));// Update lokalen State\nsetMessages(prev=>prev.map(msg=>msg.id===messageId?_objectSpread(_objectSpread({},msg),{},{is_read:false,read_at:null}):msg));// Update Stats\nconst message=messages.find(m=>m.id===messageId);setStats(prev=>_objectSpread(_objectSpread({},prev),{},{unread:prev.unread+1,unread_high_priority:(message===null||message===void 0?void 0:message.priority)==='high'?prev.unread_high_priority+1:prev.unread_high_priority}));toast.success('Als ungelesen markiert');}catch(error){console.error('Fehler beim Markieren als ungelesen:',error);toast.error('Fehler beim Markieren');}};const deleteMessage=async messageId=>{if(!window.confirm('Möchtest du diese Nachricht wirklich löschen?'))return;try{await api.delete(\"/messages/\".concat(messageId));// Update lokalen State\nconst deletedMessage=messages.find(m=>m.id===messageId);setMessages(prev=>prev.filter(msg=>msg.id!==messageId));// Update Stats wenn ungelesen\nif(!(deletedMessage!==null&&deletedMessage!==void 0&&deletedMessage.is_read)){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{unread:Math.max(0,prev.unread-1),unread_high_priority:deletedMessage.priority==='high'?Math.max(0,prev.unread_high_priority-1):prev.unread_high_priority}));}// Schließe Details wenn gelöschte Nachricht angezeigt wird\nif((selectedMessage===null||selectedMessage===void 0?void 0:selectedMessage.id)===messageId){setShowDetails(false);setSelectedMessage(null);}toast.success('Nachricht gelöscht');}catch(error){console.error('Fehler beim Löschen:',error);toast.error('Fehler beim Löschen der Nachricht');}};const getPriorityBadge=priority=>{const badges={high:{text:'Wichtig',className:'bg-red-100 text-red-800 border-red-200'},normal:{text:'Normal',className:'bg-ios-gray-100 text-ios-gray-700 border-ios-gray-200'},low:{text:'Niedrig',className:'bg-blue-100 text-blue-800 border-blue-200'}};const badge=badges[priority]||badges.normal;return/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border \".concat(badge.className),children:badge.text});};const filteredMessages=messages.filter(message=>{if(filter==='high'&&message.priority!=='high')return false;if(searchTerm){const search=searchTerm.toLowerCase();return message.subject.toLowerCase().includes(search)||message.sender_name.toLowerCase().includes(search)||message.content.toLowerCase().includes(search);}return true;});const MessageListItem=_ref=>{let{message}=_ref;const isUnread=!message.is_read;return/*#__PURE__*/_jsx(\"div\",{onClick:()=>viewMessage(message),className:\"p-4 border-b border-ios-gray-200 hover:bg-ios-gray-50 cursor-pointer transition-colors \".concat(isUnread?'bg-ios-blue/5':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:message.sender_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(message.sender_image),alt:message.sender_name,className:\"h-10 w-10 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-ios-gray-300 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserCircleIcon,{className:\"h-6 w-6 text-ios-gray-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm \".concat(isUnread?'font-semibold':'font-medium',\" text-ios-gray-900 truncate\"),children:message.subject}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600 mt-0.5\",children:message.sender_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 ml-4\",children:[message.priority==='high'&&/*#__PURE__*/_jsx(ExclamationCircleIcon,{className:\"h-4 w-4 text-red-500\"}),isUnread&&/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 rounded-full bg-ios-blue\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-500 mt-1 line-clamp-2\",children:message.content}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-ios-gray-400 mt-2\",children:formatDistanceToNow(parseISO(message.created_at),{addSuffix:true,locale:de})})]})]})});};if(loading&&messages.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-ios-gray-200 rounded w-1/4 mb-6\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:[...Array(5)].map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-4 h-24\"},i))})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-ios-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-ios-gray-900\",children:\"Nachrichten\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-ios-gray-600\",children:[stats.unread,\" ungelesene von \",stats.total_received,\" Nachrichten\"]})]}),stats.unread_high_priority>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-sm text-red-600\",children:[/*#__PURE__*/_jsx(ExclamationCircleIcon,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsxs(\"span\",{children:[stats.unread_high_priority,\" wichtige ungelesen\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 relative\",children:[/*#__PURE__*/_jsx(MagnifyingGlassIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-ios-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nachrichten durchsuchen...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full pl-10 pr-4 py-2 border border-ios-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-ios-blue focus:border-transparent\"}),searchTerm&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSearchTerm(''),className:\"absolute right-3 top-1/2 transform -translate-y-1/2\",children:/*#__PURE__*/_jsx(XMarkIcon,{className:\"h-5 w-5 text-ios-gray-400 hover:text-ios-gray-600\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(FunnelIcon,{className:\"h-5 w-5 text-ios-gray-600\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex rounded-lg overflow-hidden border border-ios-gray-300\",children:[{value:'all',label:'Alle'},{value:'unread',label:'Ungelesen'},{value:'high',label:'Wichtig'}].map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setFilter(option.value);setCurrentPage(1);},className:\"px-4 py-2 text-sm font-medium transition-colors \".concat(filter===option.value?'bg-ios-blue text-white':'bg-white text-ios-gray-700 hover:bg-ios-gray-100'),children:option.label},option.value))})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(showDetails?'hidden sm:block sm:w-1/3 lg:w-2/5':'w-full',\" border-r border-ios-gray-200 overflow-y-auto\"),children:filteredMessages.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[filteredMessages.map(message=>/*#__PURE__*/_jsx(MessageListItem,{message:message},message.id)),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.max(1,prev-1)),disabled:currentPage===1,className:\"px-3 py-1 rounded-lg border border-ios-gray-300 disabled:opacity-50\",children:\"Zur\\xFCck\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-ios-gray-600\",children:[\"Seite \",currentPage,\" von \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.min(totalPages,prev+1)),disabled:currentPage===totalPages,className:\"px-3 py-1 rounded-lg border border-ios-gray-300 disabled:opacity-50\",children:\"Weiter\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"p-12 text-center\",children:[/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"h-12 w-12 text-ios-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-ios-gray-500\",children:searchTerm?'Keine Nachrichten gefunden':'Keine Nachrichten vorhanden'})]})}),showDetails&&selectedMessage?/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto bg-white\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 bg-white border-b border-ios-gray-200 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setShowDetails(false);setSelectedMessage(null);},className:\"sm:hidden flex items-center text-ios-blue\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-5 w-5 mr-2\"}),\"Zur\\xFCck\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[!selectedMessage.is_read?/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAsUnread(selectedMessage.id),className:\"p-2 rounded-lg hover:bg-ios-gray-100\",title:\"Als ungelesen markieren\",children:/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"h-5 w-5 text-ios-gray-600\"})}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAsUnread(selectedMessage.id),className:\"p-2 rounded-lg hover:bg-ios-gray-100\",title:\"Als ungelesen markieren\",children:/*#__PURE__*/_jsx(EnvelopeOpenIcon,{className:\"h-5 w-5 text-ios-gray-600\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteMessage(selectedMessage.id),className:\"p-2 rounded-lg hover:bg-ios-gray-100 text-red-600\",title:\"L\\xF6schen\",children:/*#__PURE__*/_jsx(TrashIcon,{className:\"h-5 w-5\"})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-ios-gray-900\",children:selectedMessage.subject}),getPriorityBadge(selectedMessage.priority)]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-6 pb-6 border-b border-ios-gray-200\",children:[selectedMessage.sender_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(selectedMessage.sender_image),alt:selectedMessage.sender_name,className:\"h-12 w-12 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-12 w-12 rounded-full bg-ios-gray-300 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserCircleIcon,{className:\"h-7 w-7 text-ios-gray-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-ios-gray-900\",children:selectedMessage.sender_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:selectedMessage.sender_email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-ios-gray-500\",children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"h-4 w-4 inline mr-1\"}),format(parseISO(selectedMessage.created_at),'dd.MM.yyyy HH:mm',{locale:de})]}),selectedMessage.read_at&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-gray-400 mt-1\",children:[\"Gelesen: \",format(parseISO(selectedMessage.read_at),'dd.MM.yyyy HH:mm',{locale:de})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"prose max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap text-ios-gray-700\",children:selectedMessage.content})})]})]}):!showDetails&&messages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"hidden sm:flex flex-1 items-center justify-center bg-ios-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(EnvelopeOpenIcon,{className:\"h-12 w-12 text-ios-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-ios-gray-500\",children:\"W\\xE4hle eine Nachricht aus\"})]})})]})]});};export default MyMessages;","map":{"version":3,"names":["React","useState","useEffect","api","toast","EnvelopeIcon","EnvelopeOpenIcon","ExclamationCircleIcon","TrashIcon","ArrowLeftIcon","UserCircleIcon","ClockIcon","FunnelIcon","MagnifyingGlassIcon","XMarkIcon","format","parseISO","formatDistanceToNow","de","jsx","_jsx","jsxs","_jsxs","MyMessages","messages","setMessages","loading","setLoading","selectedMessage","setSelectedMessage","showDetails","setShowDetails","filter","setFilter","searchTerm","setSearchTerm","stats","setStats","unread","total_received","unread_high_priority","currentPage","setCurrentPage","totalPages","setTotalPages","loadMessages","loadStats","params","page","limit","response","get","data","pagination","pages","error","console","viewMessage","message","is_read","patch","concat","id","prev","map","msg","_objectSpread","read_at","Date","toISOString","Math","max","priority","markAsUnread","messageId","find","m","success","deleteMessage","window","confirm","delete","deletedMessage","getPriorityBadge","badges","high","text","className","normal","low","badge","children","filteredMessages","search","toLowerCase","subject","includes","sender_name","content","MessageListItem","_ref","isUnread","onClick","sender_image","src","alt","created_at","addSuffix","locale","length","Array","_","i","type","placeholder","value","onChange","e","target","label","option","disabled","min","title","sender_email"],"sources":["C:/Users/JRoidl/Desktop/mitarbeiterapp/frontend/src/pages/staff/MyMessages.js"],"sourcesContent":["// frontend/src/pages/staff/MyMessages.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport {\r\n  EnvelopeIcon,\r\n  EnvelopeOpenIcon,\r\n  ExclamationCircleIcon,\r\n  TrashIcon,\r\n  ArrowLeftIcon,\r\n  UserCircleIcon,\r\n  ClockIcon,\r\n  FunnelIcon,\r\n  MagnifyingGlassIcon,\r\n  XMarkIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { format, parseISO, formatDistanceToNow } from 'date-fns';\r\nimport { de } from 'date-fns/locale';\r\n\r\nconst MyMessages = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedMessage, setSelectedMessage] = useState(null);\r\n  const [showDetails, setShowDetails] = useState(false);\r\n  const [filter, setFilter] = useState('all'); // all, unread, high\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [stats, setStats] = useState({\r\n    unread: 0,\r\n    total_received: 0,\r\n    unread_high_priority: 0\r\n  });\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(1);\r\n\r\n  useEffect(() => {\r\n    loadMessages();\r\n    loadStats();\r\n  }, [currentPage, filter]);\r\n\r\n  const loadMessages = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page: currentPage,\r\n        limit: 20\r\n      };\r\n      \r\n      if (filter === 'unread') {\r\n        params.unread = true;\r\n      }\r\n      \r\n      const response = await api.get('/messages/', { params });\r\n      setMessages(response.data.messages);\r\n      setTotalPages(response.data.pagination.pages);\r\n    } catch (error) {\r\n      console.error('Fehler beim Laden der Nachrichten:', error);\r\n      toast.error('Fehler beim Laden der Nachrichten');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    try {\r\n      const response = await api.get('/messages/stats');\r\n      setStats(response.data);\r\n    } catch (error) {\r\n      console.error('Fehler beim Laden der Statistiken:', error);\r\n    }\r\n  };\r\n\r\n  const viewMessage = async (message) => {\r\n    setSelectedMessage(message);\r\n    setShowDetails(true);\r\n    \r\n    // Markiere als gelesen wenn ungelesen\r\n    if (!message.is_read) {\r\n      try {\r\n        await api.patch(`/messages/${message.id}/read`);\r\n        \r\n        // Update lokalen State\r\n        setMessages(prev => prev.map(msg => \r\n          msg.id === message.id ? { ...msg, is_read: true, read_at: new Date().toISOString() } : msg\r\n        ));\r\n        \r\n        // Update Stats\r\n        setStats(prev => ({\r\n          ...prev,\r\n          unread: Math.max(0, prev.unread - 1),\r\n          unread_high_priority: message.priority === 'high' \r\n            ? Math.max(0, prev.unread_high_priority - 1) \r\n            : prev.unread_high_priority\r\n        }));\r\n      } catch (error) {\r\n        console.error('Fehler beim Markieren als gelesen:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const markAsUnread = async (messageId) => {\r\n    try {\r\n      await api.patch(`/messages/${messageId}/unread`);\r\n      \r\n      // Update lokalen State\r\n      setMessages(prev => prev.map(msg => \r\n        msg.id === messageId ? { ...msg, is_read: false, read_at: null } : msg\r\n      ));\r\n      \r\n      // Update Stats\r\n      const message = messages.find(m => m.id === messageId);\r\n      setStats(prev => ({\r\n        ...prev,\r\n        unread: prev.unread + 1,\r\n        unread_high_priority: message?.priority === 'high' \r\n          ? prev.unread_high_priority + 1\r\n          : prev.unread_high_priority\r\n      }));\r\n      \r\n      toast.success('Als ungelesen markiert');\r\n    } catch (error) {\r\n      console.error('Fehler beim Markieren als ungelesen:', error);\r\n      toast.error('Fehler beim Markieren');\r\n    }\r\n  };\r\n\r\n  const deleteMessage = async (messageId) => {\r\n    if (!window.confirm('Möchtest du diese Nachricht wirklich löschen?')) return;\r\n    \r\n    try {\r\n      await api.delete(`/messages/${messageId}`);\r\n      \r\n      // Update lokalen State\r\n      const deletedMessage = messages.find(m => m.id === messageId);\r\n      setMessages(prev => prev.filter(msg => msg.id !== messageId));\r\n      \r\n      // Update Stats wenn ungelesen\r\n      if (!deletedMessage?.is_read) {\r\n        setStats(prev => ({\r\n          ...prev,\r\n          unread: Math.max(0, prev.unread - 1),\r\n          unread_high_priority: deletedMessage.priority === 'high' \r\n            ? Math.max(0, prev.unread_high_priority - 1)\r\n            : prev.unread_high_priority\r\n        }));\r\n      }\r\n      \r\n      // Schließe Details wenn gelöschte Nachricht angezeigt wird\r\n      if (selectedMessage?.id === messageId) {\r\n        setShowDetails(false);\r\n        setSelectedMessage(null);\r\n      }\r\n      \r\n      toast.success('Nachricht gelöscht');\r\n    } catch (error) {\r\n      console.error('Fehler beim Löschen:', error);\r\n      toast.error('Fehler beim Löschen der Nachricht');\r\n    }\r\n  };\r\n\r\n  const getPriorityBadge = (priority) => {\r\n    const badges = {\r\n      high: { text: 'Wichtig', className: 'bg-red-100 text-red-800 border-red-200' },\r\n      normal: { text: 'Normal', className: 'bg-ios-gray-100 text-ios-gray-700 border-ios-gray-200' },\r\n      low: { text: 'Niedrig', className: 'bg-blue-100 text-blue-800 border-blue-200' }\r\n    };\r\n    \r\n    const badge = badges[priority] || badges.normal;\r\n    return (\r\n      <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${badge.className}`}>\r\n        {badge.text}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const filteredMessages = messages.filter(message => {\r\n    if (filter === 'high' && message.priority !== 'high') return false;\r\n    \r\n    if (searchTerm) {\r\n      const search = searchTerm.toLowerCase();\r\n      return (\r\n        message.subject.toLowerCase().includes(search) ||\r\n        message.sender_name.toLowerCase().includes(search) ||\r\n        message.content.toLowerCase().includes(search)\r\n      );\r\n    }\r\n    \r\n    return true;\r\n  });\r\n\r\n  const MessageListItem = ({ message }) => {\r\n    const isUnread = !message.is_read;\r\n    \r\n    return (\r\n      <div\r\n        onClick={() => viewMessage(message)}\r\n        className={`p-4 border-b border-ios-gray-200 hover:bg-ios-gray-50 cursor-pointer transition-colors ${\r\n          isUnread ? 'bg-ios-blue/5' : ''\r\n        }`}\r\n      >\r\n        <div className=\"flex items-start space-x-3\">\r\n          <div className=\"flex-shrink-0\">\r\n            {message.sender_image ? (\r\n              <img\r\n                src={`/uploads/profiles/${message.sender_image}`}\r\n                alt={message.sender_name}\r\n                className=\"h-10 w-10 rounded-full object-cover\"\r\n              />\r\n            ) : (\r\n              <div className=\"h-10 w-10 rounded-full bg-ios-gray-300 flex items-center justify-center\">\r\n                <UserCircleIcon className=\"h-6 w-6 text-ios-gray-600\" />\r\n              </div>\r\n            )}\r\n          </div>\r\n          \r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-start justify-between\">\r\n              <div className=\"flex-1\">\r\n                <p className={`text-sm ${isUnread ? 'font-semibold' : 'font-medium'} text-ios-gray-900 truncate`}>\r\n                  {message.subject}\r\n                </p>\r\n                <p className=\"text-sm text-ios-gray-600 mt-0.5\">\r\n                  {message.sender_name}\r\n                </p>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center space-x-2 ml-4\">\r\n                {message.priority === 'high' && (\r\n                  <ExclamationCircleIcon className=\"h-4 w-4 text-red-500\" />\r\n                )}\r\n                {isUnread && (\r\n                  <div className=\"h-2 w-2 rounded-full bg-ios-blue\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n            \r\n            <p className=\"text-sm text-ios-gray-500 mt-1 line-clamp-2\">\r\n              {message.content}\r\n            </p>\r\n            \r\n            <p className=\"text-xs text-ios-gray-400 mt-2\">\r\n              {formatDistanceToNow(parseISO(message.created_at), { \r\n                addSuffix: true, \r\n                locale: de \r\n              })}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (loading && messages.length === 0) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-8 bg-ios-gray-200 rounded w-1/4 mb-6\"></div>\r\n          <div className=\"space-y-4\">\r\n            {[...Array(5)].map((_, i) => (\r\n              <div key={i} className=\"bg-white rounded-lg p-4 h-24\"></div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-6 border-b border-ios-gray-200\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-ios-gray-900\">Nachrichten</h1>\r\n            <p className=\"text-ios-gray-600\">\r\n              {stats.unread} ungelesene von {stats.total_received} Nachrichten\r\n            </p>\r\n          </div>\r\n          \r\n          {stats.unread_high_priority > 0 && (\r\n            <div className=\"flex items-center space-x-2 text-sm text-red-600\">\r\n              <ExclamationCircleIcon className=\"h-5 w-5\" />\r\n              <span>{stats.unread_high_priority} wichtige ungelesen</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Search and Filter */}\r\n        <div className=\"flex flex-col sm:flex-row gap-3\">\r\n          {/* Search */}\r\n          <div className=\"flex-1 relative\">\r\n            <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-ios-gray-400\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Nachrichten durchsuchen...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full pl-10 pr-4 py-2 border border-ios-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-ios-blue focus:border-transparent\"\r\n            />\r\n            {searchTerm && (\r\n              <button\r\n                onClick={() => setSearchTerm('')}\r\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2\"\r\n              >\r\n                <XMarkIcon className=\"h-5 w-5 text-ios-gray-400 hover:text-ios-gray-600\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Filter */}\r\n          <div className=\"flex items-center space-x-2\">\r\n            <FunnelIcon className=\"h-5 w-5 text-ios-gray-600\" />\r\n            <div className=\"flex rounded-lg overflow-hidden border border-ios-gray-300\">\r\n              {[\r\n                { value: 'all', label: 'Alle' },\r\n                { value: 'unread', label: 'Ungelesen' },\r\n                { value: 'high', label: 'Wichtig' }\r\n              ].map(option => (\r\n                <button\r\n                  key={option.value}\r\n                  onClick={() => {\r\n                    setFilter(option.value);\r\n                    setCurrentPage(1);\r\n                  }}\r\n                  className={`px-4 py-2 text-sm font-medium transition-colors ${\r\n                    filter === option.value\r\n                      ? 'bg-ios-blue text-white'\r\n                      : 'bg-white text-ios-gray-700 hover:bg-ios-gray-100'\r\n                  }`}\r\n                >\r\n                  {option.label}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Content */}\r\n      <div className=\"flex-1 flex overflow-hidden\">\r\n        {/* Message List */}\r\n        <div className={`${showDetails ? 'hidden sm:block sm:w-1/3 lg:w-2/5' : 'w-full'} border-r border-ios-gray-200 overflow-y-auto`}>\r\n          {filteredMessages.length > 0 ? (\r\n            <div>\r\n              {filteredMessages.map(message => (\r\n                <MessageListItem key={message.id} message={message} />\r\n              ))}\r\n              \r\n              {/* Pagination */}\r\n              {totalPages > 1 && (\r\n                <div className=\"p-4 flex items-center justify-center space-x-2\">\r\n                  <button\r\n                    onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\r\n                    disabled={currentPage === 1}\r\n                    className=\"px-3 py-1 rounded-lg border border-ios-gray-300 disabled:opacity-50\"\r\n                  >\r\n                    Zurück\r\n                  </button>\r\n                  <span className=\"text-sm text-ios-gray-600\">\r\n                    Seite {currentPage} von {totalPages}\r\n                  </span>\r\n                  <button\r\n                    onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\r\n                    disabled={currentPage === totalPages}\r\n                    className=\"px-3 py-1 rounded-lg border border-ios-gray-300 disabled:opacity-50\"\r\n                  >\r\n                    Weiter\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <div className=\"p-12 text-center\">\r\n              <EnvelopeIcon className=\"h-12 w-12 text-ios-gray-300 mx-auto mb-4\" />\r\n              <p className=\"text-ios-gray-500\">\r\n                {searchTerm ? 'Keine Nachrichten gefunden' : 'Keine Nachrichten vorhanden'}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Message Detail */}\r\n        {showDetails && selectedMessage ? (\r\n          <div className=\"flex-1 overflow-y-auto bg-white\">\r\n            {/* Detail Header */}\r\n            <div className=\"sticky top-0 bg-white border-b border-ios-gray-200 p-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <button\r\n                  onClick={() => {\r\n                    setShowDetails(false);\r\n                    setSelectedMessage(null);\r\n                  }}\r\n                  className=\"sm:hidden flex items-center text-ios-blue\"\r\n                >\r\n                  <ArrowLeftIcon className=\"h-5 w-5 mr-2\" />\r\n                  Zurück\r\n                </button>\r\n                \r\n                <div className=\"flex items-center space-x-2\">\r\n                  {!selectedMessage.is_read ? (\r\n                    <button\r\n                      onClick={() => markAsUnread(selectedMessage.id)}\r\n                      className=\"p-2 rounded-lg hover:bg-ios-gray-100\"\r\n                      title=\"Als ungelesen markieren\"\r\n                    >\r\n                      <EnvelopeIcon className=\"h-5 w-5 text-ios-gray-600\" />\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      onClick={() => markAsUnread(selectedMessage.id)}\r\n                      className=\"p-2 rounded-lg hover:bg-ios-gray-100\"\r\n                      title=\"Als ungelesen markieren\"\r\n                    >\r\n                      <EnvelopeOpenIcon className=\"h-5 w-5 text-ios-gray-600\" />\r\n                    </button>\r\n                  )}\r\n                  \r\n                  <button\r\n                    onClick={() => deleteMessage(selectedMessage.id)}\r\n                    className=\"p-2 rounded-lg hover:bg-ios-gray-100 text-red-600\"\r\n                    title=\"Löschen\"\r\n                  >\r\n                    <TrashIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Message Content */}\r\n            <div className=\"p-6\">\r\n              {/* Subject and Priority */}\r\n              <div className=\"mb-6\">\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <h2 className=\"text-xl font-semibold text-ios-gray-900\">\r\n                    {selectedMessage.subject}\r\n                  </h2>\r\n                  {getPriorityBadge(selectedMessage.priority)}\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Sender Info */}\r\n              <div className=\"flex items-center space-x-3 mb-6 pb-6 border-b border-ios-gray-200\">\r\n                {selectedMessage.sender_image ? (\r\n                  <img\r\n                    src={`/uploads/profiles/${selectedMessage.sender_image}`}\r\n                    alt={selectedMessage.sender_name}\r\n                    className=\"h-12 w-12 rounded-full object-cover\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"h-12 w-12 rounded-full bg-ios-gray-300 flex items-center justify-center\">\r\n                    <UserCircleIcon className=\"h-7 w-7 text-ios-gray-600\" />\r\n                  </div>\r\n                )}\r\n                \r\n                <div>\r\n                  <p className=\"font-medium text-ios-gray-900\">\r\n                    {selectedMessage.sender_name}\r\n                  </p>\r\n                  <p className=\"text-sm text-ios-gray-600\">\r\n                    {selectedMessage.sender_email}\r\n                  </p>\r\n                </div>\r\n                \r\n                <div className=\"flex-1 text-right\">\r\n                  <p className=\"text-sm text-ios-gray-500\">\r\n                    <ClockIcon className=\"h-4 w-4 inline mr-1\" />\r\n                    {format(parseISO(selectedMessage.created_at), 'dd.MM.yyyy HH:mm', { locale: de })}\r\n                  </p>\r\n                  {selectedMessage.read_at && (\r\n                    <p className=\"text-xs text-ios-gray-400 mt-1\">\r\n                      Gelesen: {format(parseISO(selectedMessage.read_at), 'dd.MM.yyyy HH:mm', { locale: de })}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Message Body */}\r\n              <div className=\"prose max-w-none\">\r\n                <p className=\"whitespace-pre-wrap text-ios-gray-700\">\r\n                  {selectedMessage.content}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          !showDetails && messages.length > 0 && (\r\n            <div className=\"hidden sm:flex flex-1 items-center justify-center bg-ios-gray-50\">\r\n              <div className=\"text-center\">\r\n                <EnvelopeOpenIcon className=\"h-12 w-12 text-ios-gray-300 mx-auto mb-4\" />\r\n                <p className=\"text-ios-gray-500\">Wähle eine Nachricht aus</p>\r\n              </div>\r\n            </div>\r\n          )\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default \r\n\r\nMyMessages;\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}