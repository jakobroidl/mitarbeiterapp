{"ast":null,"code":"import _objectSpread from\"C:/Users/JRoidl/Desktop/mitarbeiterapp/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// frontend/src/pages/admin/ShiftPlanning.js\nimport React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../../services/api';import toast from'react-hot-toast';import{format,parseISO}from'date-fns';import{de}from'date-fns/locale';import{ArrowLeftIcon,CalendarDaysIcon,UserGroupIcon,ClockIcon,CheckCircleIcon,XCircleIcon,ExclamationTriangleIcon,UserIcon,ChevronDownIcon,ChevronUpIcon,SparklesIcon,EnvelopeIcon,EyeIcon,PlusIcon,TrashIcon,AcademicCapIcon,ShieldExclamationIcon,FunnelIcon,InformationCircleIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShiftPlanning=()=>{var _shiftPlan$shifts$fin3;const{id}=useParams();const navigate=useNavigate();const[event,setEvent]=useState(null);const[shiftPlan,setShiftPlan]=useState(null);const[loading,setLoading]=useState(true);const[processing,setProcessing]=useState(false);const[expandedShifts,setExpandedShifts]=useState({});const[selectedStaff,setSelectedStaff]=useState({});const[filterQualification,setFilterQualification]=useState('');const[filterFullyQualified,setFilterFullyQualified]=useState(false);const[filterNoConflicts,setFilterNoConflicts]=useState(true);const[qualifications,setQualifications]=useState([]);const[showStatusDialog,setShowStatusDialog]=useState(false);const[statusAction,setStatusAction]=useState({type:'',shiftId:null});const[selectedShiftForAssignment,setSelectedShiftForAssignment]=useState(null);const[showStaffDetails,setShowStaffDetails]=useState(null);useEffect(()=>{loadEventAndShiftPlan();loadQualifications();},[id]);const loadEventAndShiftPlan=async()=>{try{setLoading(true);const[eventRes,shiftPlanRes]=await Promise.all([api.get(\"/events/\".concat(id)),api.get(\"/shifts/event/\".concat(id,\"/plan\"))]);setEvent(eventRes.data);setShiftPlan(shiftPlanRes.data);// Initialize expanded state for all shifts\nconst expanded={};shiftPlanRes.data.shifts.forEach(shift=>{expanded[shift.id]=true;});setExpandedShifts(expanded);}catch(error){console.error('Fehler beim Laden der Schichtplanung:',error);toast.error('Schichtplanung konnte nicht geladen werden');navigate(\"/admin/events/\".concat(id));}finally{setLoading(false);}};const loadQualifications=async()=>{try{const response=await api.get('/settings/qualifications');setQualifications(response.data.qualifications.filter(q=>q.is_active));}catch(error){console.error('Fehler beim Laden der Qualifikationen:',error);}};const toggleShiftExpanded=shiftId=>{setExpandedShifts(prev=>_objectSpread(_objectSpread({},prev),{},{[shiftId]:!prev[shiftId]}));};const handleAssignStaff=async function(shiftId,staffId){let positionId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;try{const requestData={staff_id:staffId,status:'preliminary'};if(positionId){requestData.position_id=positionId;}await api.post(\"/shifts/\".concat(shiftId,\"/assign\"),requestData);toast.success('Mitarbeiter erfolgreich eingeteilt');loadEventAndShiftPlan();}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;console.error('Fehler beim Einteilen:',error);// Spezifische Fehlermeldungen anzeigen\nif((_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&_error$response$data.conflicts){const conflicts=error.response.data.conflicts;toast.error(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:error.response.data.message}),/*#__PURE__*/_jsx(\"ul\",{className:\"mt-2 text-sm\",children:conflicts.map((c,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",c.event,\": \",c.time]},i))})]}),{duration:6000});}else if((_error$response2=error.response)!==null&&_error$response2!==void 0&&(_error$response2$data=_error$response2.data)!==null&&_error$response2$data!==void 0&&_error$response2$data.details){toast.error(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:error.response.data.message}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1\",children:error.response.data.details.message})]}),{duration:5000});}else{var _error$response3,_error$response3$data;toast.error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Fehler beim Einteilen des Mitarbeiters');}}};const handleRemoveAssignment=async(shiftId,staffId)=>{if(!window.confirm('Einteilung wirklich entfernen?'))return;try{await api.delete(\"/shifts/\".concat(shiftId,\"/assign/\").concat(staffId));toast.success('Einteilung entfernt');loadEventAndShiftPlan();}catch(error){console.error('Fehler beim Entfernen:',error);toast.error('Einteilung konnte nicht entfernt werden');}};const handleBulkAssign=async shiftId=>{const staffIds=Object.entries(selectedStaff).filter(_ref=>{let[key,value]=_ref;return key.startsWith(\"\".concat(shiftId,\"-\"))&&value;}).map(_ref2=>{let[key]=_ref2;return parseInt(key.split('-')[1]);});if(staffIds.length===0){toast.error('Bitte wählen Sie mindestens einen Mitarbeiter aus');return;}setProcessing(true);try{await api.post(\"/shifts/\".concat(shiftId,\"/bulk-assign\"),{assignments:staffIds.map(staff_id=>({staff_id}))});toast.success(\"\".concat(staffIds.length,\" Mitarbeiter erfolgreich eingeteilt\"));setSelectedStaff({});loadEventAndShiftPlan();}catch(error){console.error('Fehler beim Bulk-Assign:',error);toast.error('Fehler beim Einteilen der Mitarbeiter');}finally{setProcessing(false);}};const handleStatusChange=async(shiftId,newStatus)=>{setProcessing(true);try{await api.patch(\"/shifts/\".concat(shiftId,\"/status\"),{status:newStatus});toast.success(\"Schichtstatus auf '\".concat(newStatus==='final'?'Endgültig':'Vorläufig',\"' ge\\xE4ndert\"));setShowStatusDialog(false);setStatusAction({type:'',shiftId:null});loadEventAndShiftPlan();}catch(error){console.error('Fehler beim Ändern des Status:',error);toast.error('Status konnte nicht geändert werden');}finally{setProcessing(false);}};const handleAllShiftsStatus=async newStatus=>{if(!window.confirm(\"Wirklich alle Schichten auf '\".concat(newStatus==='final'?'Endgültig':'Vorläufig',\"' setzen?\")))return;setProcessing(true);try{await Promise.all(shiftPlan.shifts.map(shift=>api.patch(\"/shifts/\".concat(shift.id,\"/status\"),{status:newStatus})));toast.success('Status für alle Schichten geändert');loadEventAndShiftPlan();}catch(error){console.error('Fehler beim Ändern des Status:',error);toast.error('Status konnte nicht für alle Schichten geändert werden');}finally{setProcessing(false);}};// Filter verfügbare Mitarbeiter\nconst getFilteredAvailableStaff=()=>{if(!shiftPlan||!shiftPlan.availableStaff)return[];return shiftPlan.availableStaff.filter(staff=>{var _staff$qualifications;// Qualifikationsfilter\nif(filterQualification&&!((_staff$qualifications=staff.qualifications)!==null&&_staff$qualifications!==void 0&&_staff$qualifications.includes(filterQualification))){return false;}// Filter für voll qualifizierte\nif(filterFullyQualified&&selectedShiftForAssignment){const shift=shiftPlan.shifts.find(s=>s.id===selectedShiftForAssignment);if(shift&&shift.required_qualifications){var _shift$qualification_,_staff$qualification_;const requiredQuals=((_shift$qualification_=shift.qualification_ids)===null||_shift$qualification_===void 0?void 0:_shift$qualification_.split(','))||[];const staffQuals=((_staff$qualification_=staff.qualification_ids)===null||_staff$qualification_===void 0?void 0:_staff$qualification_.split(','))||[];const hasAll=requiredQuals.every(reqId=>staffQuals.includes(reqId));if(!hasAll)return false;}}// Filter für Konflikte\nif(filterNoConflicts&&selectedShiftForAssignment){var _shiftPlan$shifts$fin,_shiftPlan$shifts$fin2;const applicant=(_shiftPlan$shifts$fin=shiftPlan.shifts.find(s=>s.id===selectedShiftForAssignment))===null||_shiftPlan$shifts$fin===void 0?void 0:(_shiftPlan$shifts$fin2=_shiftPlan$shifts$fin.applications)===null||_shiftPlan$shifts$fin2===void 0?void 0:_shiftPlan$shifts$fin2.find(a=>a.staff_id===staff.id);if(applicant!==null&&applicant!==void 0&&applicant.has_conflicts)return false;}return true;});};const getAssignmentStatusColor=assignment=>{switch(assignment.status){case'confirmed':return'bg-ios-green/10 border-ios-green text-ios-green';case'final':return'bg-ios-blue/10 border-ios-blue text-ios-blue';case'preliminary':return'bg-ios-orange/10 border-ios-orange text-ios-orange';default:return'bg-ios-gray-100 border-ios-gray-300 text-ios-gray-700';}};const getShiftCoverageStatus=shift=>{const percentage=shift.coverage.assigned/shift.coverage.required*100;if(percentage>=100)return{color:'text-ios-green',bg:'bg-ios-green'};if(percentage>=50)return{color:'text-ios-orange',bg:'bg-ios-orange'};return{color:'text-ios-red',bg:'bg-ios-red'};};const getQualificationBadge=qual=>{const colors={'Barkeeper':'bg-orange-100 text-orange-800 border-orange-200','Kassierer':'bg-green-100 text-green-800 border-green-200','Security':'bg-red-100 text-red-800 border-red-200','Auf-/Abbau':'bg-blue-100 text-blue-800 border-blue-200','Garderobe':'bg-purple-100 text-purple-800 border-purple-200','Einlass':'bg-indigo-100 text-indigo-800 border-indigo-200'};return colors[qual]||'bg-gray-100 text-gray-800 border-gray-200';};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-ios-gray-200 rounded w-1/4 mb-6\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ios-card p-6 space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-32 bg-ios-gray-200 rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-20 bg-ios-gray-200 rounded\"})]})]})});}if(!event||!shiftPlan)return null;const filteredAvailableStaff=getFilteredAvailableStaff();return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/admin/events/\".concat(id)),className:\"p-2 rounded-lg hover:bg-ios-gray-100\",children:/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-5 w-5 text-ios-gray-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-ios-gray-900\",children:\"Schichtplanung\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-ios-gray-600\",children:event.name})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAllShiftsStatus('preliminary'),disabled:processing,className:\"ios-button-secondary\",children:\"Alle vorl\\xE4ufig\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleAllShiftsStatus('final'),disabled:processing,className:\"ios-button-primary\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-5 w-5 mr-2\"}),\"Alle endg\\xFCltig\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ios-card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:\"Schichten\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-ios-gray-900\",children:shiftPlan.stats.totalShifts})]}),/*#__PURE__*/_jsx(CalendarDaysIcon,{className:\"h-8 w-8 text-ios-blue\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ios-card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:\"Ben\\xF6tigt\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-ios-gray-900\",children:shiftPlan.stats.totalPositionsNeeded})]}),/*#__PURE__*/_jsx(UserGroupIcon,{className:\"h-8 w-8 text-ios-purple\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ios-card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:\"Eingeteilt\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-ios-gray-900\",children:shiftPlan.stats.totalAssigned})]}),/*#__PURE__*/_jsx(UserIcon,{className:\"h-8 w-8 text-ios-orange\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ios-card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:\"Bewerbungen\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-ios-purple\",children:shiftPlan.stats.totalApplications})]}),/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"h-8 w-8 text-ios-purple\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ios-card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-600\",children:\"Best\\xE4tigt\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-ios-green\",children:shiftPlan.shifts.reduce((sum,shift)=>sum+shift.coverage.confirmed,0)})]}),/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-8 w-8 text-ios-green\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-ios-gray-900\",children:\"Schichten\"}),shiftPlan.shifts.map(shift=>{const coverageStatus=getShiftCoverageStatus(shift);const isExpanded=expandedShifts[shift.id];return/*#__PURE__*/_jsxs(\"div\",{className:\"ios-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 cursor-pointer\",onClick:()=>toggleShiftExpanded(shift.id),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-ios-gray-900\",children:shift.name}),shift.position_name&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-ios-purple/10 text-ios-purple\",children:shift.position_name})]}),shift.required_qualifications&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-2 space-x-2\",children:[/*#__PURE__*/_jsx(AcademicCapIcon,{className:\"h-4 w-4 text-ios-gray-500\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:shift.required_qualifications.split(', ').map((qual,idx)=>/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border \".concat(getQualificationBadge(qual)),children:qual},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-2 text-sm text-ios-gray-600\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"inline h-4 w-4 mr-1\"}),format(parseISO(shift.start_time),'HH:mm'),\" - \",format(parseISO(shift.end_time),'HH:mm')]}),/*#__PURE__*/_jsxs(\"span\",{className:coverageStatus.color,children:[/*#__PURE__*/_jsx(UserGroupIcon,{className:\"inline h-4 w-4 mr-1\"}),shift.coverage.assigned,\"/\",shift.required_staff,\" besetzt\"]}),shift.coverage.applicants>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-ios-purple\",children:[/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"inline h-4 w-4 mr-1\"}),shift.coverage.applicants,\" Bewerbungen\",shift.coverage.qualified_applicants>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-ios-green ml-1\",children:[\"(\",shift.coverage.qualified_applicants,\" qualifiziert)\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-2 bg-ios-gray-200 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full \".concat(coverageStatus.bg,\" transition-all duration-300\"),style:{width:\"\".concat(Math.min(100,shift.coverage.assigned/shift.required_staff*100),\"%\")}})}),isExpanded?/*#__PURE__*/_jsx(ChevronUpIcon,{className:\"h-5 w-5 text-ios-gray-400\"}):/*#__PURE__*/_jsx(ChevronDownIcon,{className:\"h-5 w-5 text-ios-gray-400\"})]})]})}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-ios-gray-200\",children:[shift.assignments.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-ios-gray-700 mb-3\",children:\"Eingeteilte Mitarbeiter\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:shift.assignments.map(assignment=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-xl border \".concat(getAssignmentStatusColor(assignment)),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[assignment.profile_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(assignment.profile_image),alt:assignment.staff_name,className:\"h-8 w-8 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 rounded-full bg-ios-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserIcon,{className:\"h-4 w-4 text-ios-gray-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-ios-gray-900\",children:assignment.staff_name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-gray-500\",children:[assignment.personal_code,\" \\u2022 \",assignment.staff_qualifications||'Keine Qualifikationen']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[assignment.status==='confirmed'&&/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-5 w-5 text-ios-green\",title:\"Best\\xE4tigt\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleRemoveAssignment(shift.id,assignment.staff_id);},className:\"text-ios-red hover:text-red-600\",children:/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4\"})})]})]},assignment.id))})]}),shift.applications.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-ios-gray-50\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-sm font-medium text-ios-gray-700 mb-3\",children:[\"Bewerbungen (\",shift.applications.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:shift.applications.map(applicant=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-xl bg-white border \".concat(applicant.has_conflicts?'border-ios-red/20':'border-ios-gray-200'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[applicant.profile_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(applicant.profile_image),alt:applicant.staff_name,className:\"h-8 w-8 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 rounded-full bg-ios-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserIcon,{className:\"h-4 w-4 text-ios-gray-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-medium text-ios-gray-900 flex items-center\",children:[applicant.staff_name,applicant.fully_qualified&&/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-ios-green ml-2\",title:\"Voll qualifiziert\"}),applicant.has_conflicts&&/*#__PURE__*/_jsx(ExclamationTriangleIcon,{className:\"h-4 w-4 text-ios-red ml-2\",title:\"Hat Zeitkonflikte\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-ios-gray-500\",children:applicant.qualifications||'Keine Qualifikationen'}),applicant.qualification_match&&!applicant.fully_qualified&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-orange mt-1\",children:[applicant.qualification_match.has,\" von \",applicant.qualification_match.required,\" Qualifikationen\"]}),applicant.has_conflicts&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-red mt-1\",children:[\"Konflikt mit: \",applicant.conflicts.map(c=>c.shift_name).join(', ')]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleAssignStaff(shift.id,applicant.staff_id,shift.position_id);},disabled:applicant.has_conflicts,className:\"ios-button-primary text-sm px-3 py-1 \".concat(applicant.has_conflicts?'opacity-50 cursor-not-allowed':''),children:\"Einteilen\"})})]},applicant.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-ios-gray-50 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[shift.assignments.filter(a=>a.status==='preliminary').length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-ios-orange\",children:[/*#__PURE__*/_jsx(ExclamationTriangleIcon,{className:\"inline h-4 w-4 mr-1\"}),shift.assignments.filter(a=>a.status==='preliminary').length,\" vorl\\xE4ufig\"]}),shift.assignments.filter(a=>a.status==='final').length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-ios-blue\",children:[/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"inline h-4 w-4 mr-1\"}),shift.assignments.filter(a=>a.status==='final').length,\" endg\\xFCltig\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();setSelectedShiftForAssignment(shift.id);},className:\"ios-button-secondary text-sm\",children:[/*#__PURE__*/_jsx(PlusIcon,{className:\"h-4 w-4 mr-1\"}),\"Mitarbeiter zuweisen\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setStatusAction({type:'shift',shiftId:shift.id});setShowStatusDialog(true);},className:\"ios-button-secondary text-sm\",children:\"Status \\xE4ndern\"})]})]})]})]},shift.id);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-ios-gray-900\",children:\"Verf\\xFCgbare Mitarbeiter\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-ios-gray-500\",children:[filteredAvailableStaff.length,\" verf\\xFCgbar\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ios-card p-4 space-y-3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-sm font-medium text-ios-gray-700 flex items-center\",children:[/*#__PURE__*/_jsx(FunnelIcon,{className:\"h-4 w-4 mr-2\"}),\"Filter\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-ios-gray-600 mb-1\",children:\"Qualifikation\"}),/*#__PURE__*/_jsxs(\"select\",{value:filterQualification,onChange:e=>setFilterQualification(e.target.value),className:\"ios-input w-full text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Alle Qualifikationen\"}),qualifications.map(qual=>/*#__PURE__*/_jsx(\"option\",{value:qual.name,children:qual.name},qual.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterFullyQualified,onChange:e=>setFilterFullyQualified(e.target.checked),className:\"rounded text-ios-blue focus:ring-ios-blue mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-ios-gray-700\",children:\"Nur voll qualifizierte\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterNoConflicts,onChange:e=>setFilterNoConflicts(e.target.checked),className:\"rounded text-ios-blue focus:ring-ios-blue mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-ios-gray-700\",children:\"Ohne Zeitkonflikte\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ios-card p-4 max-h-[calc(100vh-400px)] overflow-y-auto\",children:[selectedShiftForAssignment&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 p-3 bg-ios-blue/10 rounded-xl\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium text-ios-blue\",children:[\"Mitarbeiter f\\xFCr \\\"\",(_shiftPlan$shifts$fin3=shiftPlan.shifts.find(s=>s.id===selectedShiftForAssignment))===null||_shiftPlan$shifts$fin3===void 0?void 0:_shiftPlan$shifts$fin3.name,\"\\\" ausw\\xE4hlen\"]})}),filteredAvailableStaff.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:filteredAvailableStaff.map(staff=>{// Check if staff is already assigned to any shift\nconst isAssigned=shiftPlan.shifts.some(shift=>shift.assignments.some(a=>a.staff_id===staff.id));// Get qualification match for selected shift\nlet qualificationMatch=null;if(selectedShiftForAssignment){var _shift$applications;const shift=shiftPlan.shifts.find(s=>s.id===selectedShiftForAssignment);const applicant=shift===null||shift===void 0?void 0:(_shift$applications=shift.applications)===null||_shift$applications===void 0?void 0:_shift$applications.find(a=>a.staff_id===staff.id);qualificationMatch=applicant===null||applicant===void 0?void 0:applicant.qualification_match;}return/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-xl border \".concat(isAssigned?'border-ios-gray-200 bg-ios-gray-50 opacity-50':'border-ios-gray-200 hover:border-ios-gray-300 cursor-pointer'),onClick:()=>{if(!isAssigned&&selectedShiftForAssignment){handleAssignStaff(selectedShiftForAssignment,staff.id);}},draggable:!isAssigned,onDragStart:e=>{e.dataTransfer.setData('staffId',staff.id.toString());},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[staff.profile_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(staff.profile_image),alt:staff.name,className:\"h-10 w-10 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-ios-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserIcon,{className:\"h-5 w-5 text-ios-gray-500\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-medium text-ios-gray-900 truncate flex items-center\",children:[staff.name,isAssigned&&/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-ios-green ml-2 flex-shrink-0\",title:\"Bereits eingeteilt\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-gray-500 truncate\",children:[staff.personal_code,\" \\u2022 \",staff.qualifications||'Keine']}),qualificationMatch&&!qualificationMatch.hasAll&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-orange mt-1\",children:[qualificationMatch.has,\" von \",qualificationMatch.required,\" Qualifikationen\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setShowStaffDetails(staff);},className:\"p-1 hover:bg-ios-gray-100 rounded\",children:/*#__PURE__*/_jsx(InformationCircleIcon,{className:\"h-5 w-5 text-ios-gray-400\"})})]})},staff.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-ios-gray-500 py-4\",children:\"Keine verf\\xFCgbaren Mitarbeiter mit den gew\\xE4hlten Filtern\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ios-card p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-ios-gray-700 mb-3\",children:\"Schnellzuweisung\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-ios-gray-500 mb-3\",children:\"Klicken Sie auf einen Mitarbeiter oder ziehen Sie ihn auf eine Schicht\"}),shiftPlan.shifts.map(shift=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 border-2 border-dashed rounded-xl transition-colors \".concat(selectedShiftForAssignment===shift.id?'border-ios-blue bg-ios-blue/5':'border-ios-gray-300 hover:border-ios-blue'),onClick:()=>setSelectedShiftForAssignment(shift.id),onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();const staffId=parseInt(e.dataTransfer.getData('staffId'));handleAssignStaff(shift.id,staffId);},children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-ios-gray-700\",children:shift.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-ios-gray-500 mt-1\",children:[shift.coverage.assigned,\"/\",shift.required_staff,\" besetzt\",shift.required_qualifications&&/*#__PURE__*/_jsxs(\"span\",{className:\"block mt-1\",children:[\"Ben\\xF6tigt: \",shift.required_qualifications]})]})]},shift.id))]})]})]}),showStatusDialog&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex min-h-full items-center justify-center p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/40 backdrop-blur-sm\",onClick:()=>setShowStatusDialog(false)}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-white rounded-2xl shadow-xl max-w-md w-full p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-ios-gray-900 mb-4\",children:\"Schichtstatus \\xE4ndern\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-ios-gray-600 mb-6\",children:[\"W\\xE4hlen Sie den neuen Status f\\xFCr \",statusAction.type==='all'?'alle Schichten':'diese Schicht',\":\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleStatusChange(statusAction.shiftId,'preliminary'),className:\"w-full p-4 rounded-xl border-2 border-ios-orange hover:bg-ios-orange/10 transition-colors text-left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(ExclamationTriangleIcon,{className:\"h-6 w-6 text-ios-orange\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-ios-gray-900\",children:\"Vorl\\xE4ufig\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-ios-gray-500\",children:\"Mitarbeiter k\\xF6nnen noch nicht best\\xE4tigen\"})]})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleStatusChange(statusAction.shiftId,'final'),className:\"w-full p-4 rounded-xl border-2 border-ios-blue hover:bg-ios-blue/10 transition-colors text-left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-6 w-6 text-ios-blue\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-ios-gray-900\",children:\"Endg\\xFCltig\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-ios-gray-500\",children:\"Mitarbeiter werden benachrichtigt und k\\xF6nnen best\\xE4tigen\"})]})]})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowStatusDialog(false);setStatusAction({type:'',shiftId:null});},className:\"w-full ios-button-secondary\",children:\"Abbrechen\"})]})]})}),showStaffDetails&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex min-h-full items-center justify-center p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/40 backdrop-blur-sm\",onClick:()=>setShowStaffDetails(null)}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-white rounded-2xl shadow-xl max-w-md w-full p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-ios-gray-900\",children:\"Mitarbeiter-Details\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowStaffDetails(null),className:\"p-1 rounded-lg hover:bg-ios-gray-100\",children:/*#__PURE__*/_jsx(XCircleIcon,{className:\"h-5 w-5 text-ios-gray-600\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[showStaffDetails.profile_image?/*#__PURE__*/_jsx(\"img\",{src:\"/uploads/profiles/\".concat(showStaffDetails.profile_image),alt:showStaffDetails.name,className:\"h-16 w-16 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"h-16 w-16 rounded-full bg-ios-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(UserIcon,{className:\"h-8 w-8 text-ios-gray-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-ios-gray-900\",children:showStaffDetails.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-ios-gray-500\",children:showStaffDetails.personal_code})]})]}),showStaffDetails.qualifications&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-ios-gray-700 mb-2\",children:\"Qualifikationen\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:showStaffDetails.qualifications.split(', ').map((qual,idx)=>/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border \".concat(getQualificationBadge(qual)),children:qual},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-ios-gray-700 mb-2\",children:\"Schicht-Kompatibilit\\xE4t\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:shiftPlan.shifts.map(shift=>{var _shift$applications2;const applicant=(_shift$applications2=shift.applications)===null||_shift$applications2===void 0?void 0:_shift$applications2.find(a=>a.staff_id===showStaffDetails.id);const hasApplied=!!applicant;const isQualified=applicant===null||applicant===void 0?void 0:applicant.fully_qualified;const hasConflicts=applicant===null||applicant===void 0?void 0:applicant.has_conflicts;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-2 bg-ios-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-ios-gray-700\",children:shift.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[hasApplied&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-ios-purple\",children:\"Beworben\"}),isQualified?/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-ios-green\",title:\"Qualifiziert\"}):shift.required_qualifications&&/*#__PURE__*/_jsx(XCircleIcon,{className:\"h-4 w-4 text-ios-gray-400\",title:\"Nicht qualifiziert\"}),hasConflicts&&/*#__PURE__*/_jsx(ShieldExclamationIcon,{className:\"h-4 w-4 text-ios-red\",title:\"Zeitkonflikt\"})]})]},shift.id);})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowStaffDetails(null),className:\"w-full ios-button-secondary\",children:\"Schlie\\xDFen\"})})]})]})})]});};export default ShiftPlanning;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","api","toast","format","parseISO","de","ArrowLeftIcon","CalendarDaysIcon","UserGroupIcon","ClockIcon","CheckCircleIcon","XCircleIcon","ExclamationTriangleIcon","UserIcon","ChevronDownIcon","ChevronUpIcon","SparklesIcon","EnvelopeIcon","EyeIcon","PlusIcon","TrashIcon","AcademicCapIcon","ShieldExclamationIcon","FunnelIcon","InformationCircleIcon","jsx","_jsx","jsxs","_jsxs","ShiftPlanning","_shiftPlan$shifts$fin3","id","navigate","event","setEvent","shiftPlan","setShiftPlan","loading","setLoading","processing","setProcessing","expandedShifts","setExpandedShifts","selectedStaff","setSelectedStaff","filterQualification","setFilterQualification","filterFullyQualified","setFilterFullyQualified","filterNoConflicts","setFilterNoConflicts","qualifications","setQualifications","showStatusDialog","setShowStatusDialog","statusAction","setStatusAction","type","shiftId","selectedShiftForAssignment","setSelectedShiftForAssignment","showStaffDetails","setShowStaffDetails","loadEventAndShiftPlan","loadQualifications","eventRes","shiftPlanRes","Promise","all","get","concat","data","expanded","shifts","forEach","shift","error","console","response","filter","q","is_active","toggleShiftExpanded","prev","_objectSpread","handleAssignStaff","staffId","positionId","arguments","length","undefined","requestData","staff_id","status","position_id","post","success","_error$response","_error$response$data","_error$response2","_error$response2$data","conflicts","children","className","message","map","c","i","time","duration","details","_error$response3","_error$response3$data","handleRemoveAssignment","window","confirm","delete","handleBulkAssign","staffIds","Object","entries","_ref","key","value","startsWith","_ref2","parseInt","split","assignments","handleStatusChange","newStatus","patch","handleAllShiftsStatus","getFilteredAvailableStaff","availableStaff","staff","_staff$qualifications","includes","find","s","required_qualifications","_shift$qualification_","_staff$qualification_","requiredQuals","qualification_ids","staffQuals","hasAll","every","reqId","_shiftPlan$shifts$fin","_shiftPlan$shifts$fin2","applicant","applications","a","has_conflicts","getAssignmentStatusColor","assignment","getShiftCoverageStatus","percentage","coverage","assigned","required","color","bg","getQualificationBadge","qual","colors","filteredAvailableStaff","onClick","name","disabled","stats","totalShifts","totalPositionsNeeded","totalAssigned","totalApplications","reduce","sum","confirmed","coverageStatus","isExpanded","position_name","idx","start_time","end_time","required_staff","applicants","qualified_applicants","style","width","Math","min","profile_image","src","alt","staff_name","personal_code","staff_qualifications","title","e","stopPropagation","fully_qualified","qualification_match","has","shift_name","join","onChange","target","checked","isAssigned","some","qualificationMatch","_shift$applications","draggable","onDragStart","dataTransfer","setData","toString","onDragOver","preventDefault","onDrop","getData","_shift$applications2","hasApplied","isQualified","hasConflicts"],"sources":["C:/Users/JRoidl/Desktop/mitarbeiterapp/frontend/src/pages/admin/ShiftPlanning.js"],"sourcesContent":["// frontend/src/pages/admin/ShiftPlanning.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { de } from 'date-fns/locale';\r\nimport {\r\n  ArrowLeftIcon,\r\n  CalendarDaysIcon,\r\n  UserGroupIcon,\r\n  ClockIcon,\r\n  CheckCircleIcon,\r\n  XCircleIcon,\r\n  ExclamationTriangleIcon,\r\n  UserIcon,\r\n  ChevronDownIcon,\r\n  ChevronUpIcon,\r\n  SparklesIcon,\r\n  EnvelopeIcon,\r\n  EyeIcon,\r\n  PlusIcon,\r\n  TrashIcon,\r\n  AcademicCapIcon,\r\n  ShieldExclamationIcon,\r\n  FunnelIcon,\r\n  InformationCircleIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\nconst ShiftPlanning = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [event, setEvent] = useState(null);\r\n  const [shiftPlan, setShiftPlan] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [processing, setProcessing] = useState(false);\r\n  const [expandedShifts, setExpandedShifts] = useState({});\r\n  const [selectedStaff, setSelectedStaff] = useState({});\r\n  const [filterQualification, setFilterQualification] = useState('');\r\n  const [filterFullyQualified, setFilterFullyQualified] = useState(false);\r\n  const [filterNoConflicts, setFilterNoConflicts] = useState(true);\r\n  const [qualifications, setQualifications] = useState([]);\r\n  const [showStatusDialog, setShowStatusDialog] = useState(false);\r\n  const [statusAction, setStatusAction] = useState({ type: '', shiftId: null });\r\n  const [selectedShiftForAssignment, setSelectedShiftForAssignment] = useState(null);\r\n  const [showStaffDetails, setShowStaffDetails] = useState(null);\r\n\r\n  useEffect(() => {\r\n    loadEventAndShiftPlan();\r\n    loadQualifications();\r\n  }, [id]);\r\n\r\n  const loadEventAndShiftPlan = async () => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      const [eventRes, shiftPlanRes] = await Promise.all([\r\n        api.get(`/events/${id}`),\r\n        api.get(`/shifts/event/${id}/plan`)\r\n      ]);\r\n      \r\n      setEvent(eventRes.data);\r\n      setShiftPlan(shiftPlanRes.data);\r\n      \r\n      // Initialize expanded state for all shifts\r\n      const expanded = {};\r\n      shiftPlanRes.data.shifts.forEach(shift => {\r\n        expanded[shift.id] = true;\r\n      });\r\n      setExpandedShifts(expanded);\r\n      \r\n    } catch (error) {\r\n      console.error('Fehler beim Laden der Schichtplanung:', error);\r\n      toast.error('Schichtplanung konnte nicht geladen werden');\r\n      navigate(`/admin/events/${id}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadQualifications = async () => {\r\n    try {\r\n      const response = await api.get('/settings/qualifications');\r\n      setQualifications(response.data.qualifications.filter(q => q.is_active));\r\n    } catch (error) {\r\n      console.error('Fehler beim Laden der Qualifikationen:', error);\r\n    }\r\n  };\r\n\r\n  const toggleShiftExpanded = (shiftId) => {\r\n    setExpandedShifts(prev => ({\r\n      ...prev,\r\n      [shiftId]: !prev[shiftId]\r\n    }));\r\n  };\r\n\r\n  const handleAssignStaff = async (shiftId, staffId, positionId = null) => {\r\n    try {\r\n      const requestData = {\r\n        staff_id: staffId,\r\n        status: 'preliminary'\r\n      };\r\n      \r\n      if (positionId) {\r\n        requestData.position_id = positionId;\r\n      }\r\n      \r\n      await api.post(`/shifts/${shiftId}/assign`, requestData);\r\n      \r\n      toast.success('Mitarbeiter erfolgreich eingeteilt');\r\n      loadEventAndShiftPlan();\r\n    } catch (error) {\r\n      console.error('Fehler beim Einteilen:', error);\r\n      \r\n      // Spezifische Fehlermeldungen anzeigen\r\n      if (error.response?.data?.conflicts) {\r\n        const conflicts = error.response.data.conflicts;\r\n        toast.error(\r\n          <div>\r\n            <p className=\"font-semibold\">{error.response.data.message}</p>\r\n            <ul className=\"mt-2 text-sm\">\r\n              {conflicts.map((c, i) => (\r\n                <li key={i}>• {c.event}: {c.time}</li>\r\n              ))}\r\n            </ul>\r\n          </div>,\r\n          { duration: 6000 }\r\n        );\r\n      } else if (error.response?.data?.details) {\r\n        toast.error(\r\n          <div>\r\n            <p className=\"font-semibold\">{error.response.data.message}</p>\r\n            <p className=\"text-sm mt-1\">{error.response.data.details.message}</p>\r\n          </div>,\r\n          { duration: 5000 }\r\n        );\r\n      } else {\r\n        toast.error(error.response?.data?.message || 'Fehler beim Einteilen des Mitarbeiters');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleRemoveAssignment = async (shiftId, staffId) => {\r\n    if (!window.confirm('Einteilung wirklich entfernen?')) return;\r\n\r\n    try {\r\n      await api.delete(`/shifts/${shiftId}/assign/${staffId}`);\r\n      toast.success('Einteilung entfernt');\r\n      loadEventAndShiftPlan();\r\n    } catch (error) {\r\n      console.error('Fehler beim Entfernen:', error);\r\n      toast.error('Einteilung konnte nicht entfernt werden');\r\n    }\r\n  };\r\n\r\n  const handleBulkAssign = async (shiftId) => {\r\n    const staffIds = Object.entries(selectedStaff)\r\n      .filter(([key, value]) => key.startsWith(`${shiftId}-`) && value)\r\n      .map(([key]) => parseInt(key.split('-')[1]));\r\n\r\n    if (staffIds.length === 0) {\r\n      toast.error('Bitte wählen Sie mindestens einen Mitarbeiter aus');\r\n      return;\r\n    }\r\n\r\n    setProcessing(true);\r\n    try {\r\n      await api.post(`/shifts/${shiftId}/bulk-assign`, {\r\n        assignments: staffIds.map(staff_id => ({ staff_id }))\r\n      });\r\n      \r\n      toast.success(`${staffIds.length} Mitarbeiter erfolgreich eingeteilt`);\r\n      setSelectedStaff({});\r\n      loadEventAndShiftPlan();\r\n    } catch (error) {\r\n      console.error('Fehler beim Bulk-Assign:', error);\r\n      toast.error('Fehler beim Einteilen der Mitarbeiter');\r\n    } finally {\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (shiftId, newStatus) => {\r\n    setProcessing(true);\r\n    try {\r\n      await api.patch(`/shifts/${shiftId}/status`, { status: newStatus });\r\n      \r\n      toast.success(`Schichtstatus auf '${newStatus === 'final' ? 'Endgültig' : 'Vorläufig'}' geändert`);\r\n      setShowStatusDialog(false);\r\n      setStatusAction({ type: '', shiftId: null });\r\n      loadEventAndShiftPlan();\r\n    } catch (error) {\r\n      console.error('Fehler beim Ändern des Status:', error);\r\n      toast.error('Status konnte nicht geändert werden');\r\n    } finally {\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleAllShiftsStatus = async (newStatus) => {\r\n    if (!window.confirm(`Wirklich alle Schichten auf '${newStatus === 'final' ? 'Endgültig' : 'Vorläufig'}' setzen?`)) return;\r\n\r\n    setProcessing(true);\r\n    try {\r\n      await Promise.all(\r\n        shiftPlan.shifts.map(shift => \r\n          api.patch(`/shifts/${shift.id}/status`, { status: newStatus })\r\n        )\r\n      );\r\n      \r\n      toast.success('Status für alle Schichten geändert');\r\n      loadEventAndShiftPlan();\r\n    } catch (error) {\r\n      console.error('Fehler beim Ändern des Status:', error);\r\n      toast.error('Status konnte nicht für alle Schichten geändert werden');\r\n    } finally {\r\n      setProcessing(false);\r\n    }\r\n  };\r\n\r\n// Filter verfügbare Mitarbeiter\r\n  const getFilteredAvailableStaff = () => {\r\n    if (!shiftPlan || !shiftPlan.availableStaff) return [];\r\n    \r\n    return shiftPlan.availableStaff.filter(staff => {\r\n      // Qualifikationsfilter\r\n      if (filterQualification && !staff.qualifications?.includes(filterQualification)) {\r\n        return false;\r\n      }\r\n      \r\n      // Filter für voll qualifizierte\r\n      if (filterFullyQualified && selectedShiftForAssignment) {\r\n        const shift = shiftPlan.shifts.find(s => s.id === selectedShiftForAssignment);\r\n        if (shift && shift.required_qualifications) {\r\n          const requiredQuals = shift.qualification_ids?.split(',') || [];\r\n          const staffQuals = staff.qualification_ids?.split(',') || [];\r\n          const hasAll = requiredQuals.every(reqId => staffQuals.includes(reqId));\r\n          if (!hasAll) return false;\r\n        }\r\n      }\r\n      \r\n      // Filter für Konflikte\r\n      if (filterNoConflicts && selectedShiftForAssignment) {\r\n        const applicant = shiftPlan.shifts\r\n          .find(s => s.id === selectedShiftForAssignment)\r\n          ?.applications?.find(a => a.staff_id === staff.id);\r\n        if (applicant?.has_conflicts) return false;\r\n      }\r\n      \r\n      return true;\r\n    });\r\n  };\r\n\r\n\r\n\r\n  const getAssignmentStatusColor = (assignment) => {\r\n    switch (assignment.status) {\r\n      case 'confirmed':\r\n        return 'bg-ios-green/10 border-ios-green text-ios-green';\r\n      case 'final':\r\n        return 'bg-ios-blue/10 border-ios-blue text-ios-blue';\r\n      case 'preliminary':\r\n        return 'bg-ios-orange/10 border-ios-orange text-ios-orange';\r\n      default:\r\n        return 'bg-ios-gray-100 border-ios-gray-300 text-ios-gray-700';\r\n    }\r\n  };\r\n\r\n  const getShiftCoverageStatus = (shift) => {\r\n    const percentage = (shift.coverage.assigned / shift.coverage.required) * 100;\r\n    if (percentage >= 100) return { color: 'text-ios-green', bg: 'bg-ios-green' };\r\n    if (percentage >= 50) return { color: 'text-ios-orange', bg: 'bg-ios-orange' };\r\n    return { color: 'text-ios-red', bg: 'bg-ios-red' };\r\n  };\r\n\r\n  const getQualificationBadge = (qual) => {\r\n    const colors = {\r\n      'Barkeeper': 'bg-orange-100 text-orange-800 border-orange-200',\r\n      'Kassierer': 'bg-green-100 text-green-800 border-green-200',\r\n      'Security': 'bg-red-100 text-red-800 border-red-200',\r\n      'Auf-/Abbau': 'bg-blue-100 text-blue-800 border-blue-200',\r\n      'Garderobe': 'bg-purple-100 text-purple-800 border-purple-200',\r\n      'Einlass': 'bg-indigo-100 text-indigo-800 border-indigo-200'\r\n    };\r\n    \r\n    return colors[qual] || 'bg-gray-100 text-gray-800 border-gray-200';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-8 bg-ios-gray-200 rounded w-1/4 mb-6\"></div>\r\n          <div className=\"ios-card p-6 space-y-4\">\r\n            <div className=\"h-32 bg-ios-gray-200 rounded\"></div>\r\n            <div className=\"h-20 bg-ios-gray-200 rounded\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!event || !shiftPlan) return null;\r\n\r\n  const filteredAvailableStaff = getFilteredAvailableStaff();\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-7xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div className=\"flex items-center space-x-4\">\r\n          <button\r\n            onClick={() => navigate(`/admin/events/${id}`)}\r\n            className=\"p-2 rounded-lg hover:bg-ios-gray-100\"\r\n          >\r\n            <ArrowLeftIcon className=\"h-5 w-5 text-ios-gray-600\" />\r\n          </button>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-ios-gray-900\">Schichtplanung</h1>\r\n            <p className=\"text-ios-gray-600\">{event.name}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          <button\r\n            onClick={() => handleAllShiftsStatus('preliminary')}\r\n            disabled={processing}\r\n            className=\"ios-button-secondary\"\r\n          >\r\n            Alle vorläufig\r\n          </button>\r\n          <button\r\n            onClick={() => handleAllShiftsStatus('final')}\r\n            disabled={processing}\r\n            className=\"ios-button-primary\"\r\n          >\r\n            <CheckCircleIcon className=\"h-5 w-5 mr-2\" />\r\n            Alle endgültig\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overview Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\">\r\n        <div className=\"ios-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-ios-gray-600\">Schichten</p>\r\n              <p className=\"text-2xl font-bold text-ios-gray-900\">{shiftPlan.stats.totalShifts}</p>\r\n            </div>\r\n            <CalendarDaysIcon className=\"h-8 w-8 text-ios-blue\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"ios-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-ios-gray-600\">Benötigt</p>\r\n              <p className=\"text-2xl font-bold text-ios-gray-900\">\r\n                {shiftPlan.stats.totalPositionsNeeded}\r\n              </p>\r\n            </div>\r\n            <UserGroupIcon className=\"h-8 w-8 text-ios-purple\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"ios-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-ios-gray-600\">Eingeteilt</p>\r\n              <p className=\"text-2xl font-bold text-ios-gray-900\">\r\n                {shiftPlan.stats.totalAssigned}\r\n              </p>\r\n            </div>\r\n            <UserIcon className=\"h-8 w-8 text-ios-orange\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"ios-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-ios-gray-600\">Bewerbungen</p>\r\n              <p className=\"text-2xl font-bold text-ios-purple\">\r\n                {shiftPlan.stats.totalApplications}\r\n              </p>\r\n            </div>\r\n            <EnvelopeIcon className=\"h-8 w-8 text-ios-purple\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"ios-card p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm text-ios-gray-600\">Bestätigt</p>\r\n              <p className=\"text-2xl font-bold text-ios-green\">\r\n                {shiftPlan.shifts.reduce((sum, shift) => sum + shift.coverage.confirmed, 0)}\r\n              </p>\r\n            </div>\r\n            <CheckCircleIcon className=\"h-8 w-8 text-ios-green\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Shifts Column */}\r\n        <div className=\"lg:col-span-2 space-y-4\">\r\n          <h2 className=\"text-lg font-semibold text-ios-gray-900\">Schichten</h2>\r\n          \r\n          {shiftPlan.shifts.map((shift) => {\r\n            const coverageStatus = getShiftCoverageStatus(shift);\r\n            const isExpanded = expandedShifts[shift.id];\r\n            \r\n            return (\r\n              <div key={shift.id} className=\"ios-card\">\r\n                {/* Shift Header */}\r\n                <div \r\n                  className=\"p-4 cursor-pointer\"\r\n                  onClick={() => toggleShiftExpanded(shift.id)}\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <h3 className=\"text-lg font-semibold text-ios-gray-900\">{shift.name}</h3>\r\n                        {shift.position_name && (\r\n                          <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-ios-purple/10 text-ios-purple\">\r\n                            {shift.position_name}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Erforderliche Qualifikationen */}\r\n                      {shift.required_qualifications && (\r\n                        <div className=\"flex items-center mt-2 space-x-2\">\r\n                          <AcademicCapIcon className=\"h-4 w-4 text-ios-gray-500\" />\r\n                          <div className=\"flex flex-wrap gap-1\">\r\n                            {shift.required_qualifications.split(', ').map((qual, idx) => (\r\n                              <span\r\n                                key={idx}\r\n                                className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${getQualificationBadge(qual)}`}\r\n                              >\r\n                                {qual}\r\n                              </span>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      \r\n                      <div className=\"flex items-center space-x-4 mt-2 text-sm text-ios-gray-600\">\r\n                        <span>\r\n                          <ClockIcon className=\"inline h-4 w-4 mr-1\" />\r\n                          {format(parseISO(shift.start_time), 'HH:mm')} - {format(parseISO(shift.end_time), 'HH:mm')}\r\n                        </span>\r\n                        <span className={coverageStatus.color}>\r\n                          <UserGroupIcon className=\"inline h-4 w-4 mr-1\" />\r\n                          {shift.coverage.assigned}/{shift.required_staff} besetzt\r\n                        </span>\r\n                        {shift.coverage.applicants > 0 && (\r\n                          <span className=\"text-ios-purple\">\r\n                            <EnvelopeIcon className=\"inline h-4 w-4 mr-1\" />\r\n                            {shift.coverage.applicants} Bewerbungen\r\n                            {shift.coverage.qualified_applicants > 0 && (\r\n                              <span className=\"text-ios-green ml-1\">\r\n                                ({shift.coverage.qualified_applicants} qualifiziert)\r\n                              </span>\r\n                            )}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      {/* Coverage Bar */}\r\n                      <div className=\"w-24 h-2 bg-ios-gray-200 rounded-full overflow-hidden\">\r\n                        <div \r\n                          className={`h-full ${coverageStatus.bg} transition-all duration-300`}\r\n                          style={{ width: `${Math.min(100, (shift.coverage.assigned / shift.required_staff) * 100)}%` }}\r\n                        />\r\n                      </div>\r\n                      {isExpanded ? (\r\n                        <ChevronUpIcon className=\"h-5 w-5 text-ios-gray-400\" />\r\n                      ) : (\r\n                        <ChevronDownIcon className=\"h-5 w-5 text-ios-gray-400\" />\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Shift Content (Expandable) */}\r\n                {isExpanded && (\r\n                  <div className=\"border-t border-ios-gray-200\">\r\n                    {/* Assigned Staff */}\r\n                    {shift.assignments.length > 0 && (\r\n                      <div className=\"p-4\">\r\n                        <h4 className=\"text-sm font-medium text-ios-gray-700 mb-3\">Eingeteilte Mitarbeiter</h4>\r\n                        <div className=\"space-y-2\">\r\n                          {shift.assignments.map((assignment) => (\r\n                            <div \r\n                              key={assignment.id}\r\n                              className={`flex items-center justify-between p-3 rounded-xl border ${getAssignmentStatusColor(assignment)}`}\r\n                            >\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                {assignment.profile_image ? (\r\n                                  <img\r\n                                    src={`/uploads/profiles/${assignment.profile_image}`}\r\n                                    alt={assignment.staff_name}\r\n                                    className=\"h-8 w-8 rounded-full object-cover\"\r\n                                  />\r\n                                ) : (\r\n                                  <div className=\"h-8 w-8 rounded-full bg-ios-gray-200 flex items-center justify-center\">\r\n                                    <UserIcon className=\"h-4 w-4 text-ios-gray-500\" />\r\n                                  </div>\r\n                                )}\r\n                                <div>\r\n                                  <p className=\"font-medium text-ios-gray-900\">{assignment.staff_name}</p>\r\n                                  <p className=\"text-xs text-ios-gray-500\">\r\n                                    {assignment.personal_code} • {assignment.staff_qualifications || 'Keine Qualifikationen'}\r\n                                  </p>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                {assignment.status === 'confirmed' && (\r\n                                  <CheckCircleIcon className=\"h-5 w-5 text-ios-green\" title=\"Bestätigt\" />\r\n                                )}\r\n                                <button\r\n                                  onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    handleRemoveAssignment(shift.id, assignment.staff_id);\r\n                                  }}\r\n                                  className=\"text-ios-red hover:text-red-600\"\r\n                                >\r\n                                  <TrashIcon className=\"h-4 w-4\" />\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Applicants */}\r\n                    {shift.applications.length > 0 && (\r\n                      <div className=\"p-4 bg-ios-gray-50\">\r\n                        <h4 className=\"text-sm font-medium text-ios-gray-700 mb-3\">\r\n                          Bewerbungen ({shift.applications.length})\r\n                        </h4>\r\n                        <div className=\"space-y-2\">\r\n                          {shift.applications.map((applicant) => (\r\n                            <div \r\n                              key={applicant.id}\r\n                              className={`flex items-center justify-between p-3 rounded-xl bg-white border ${\r\n                                applicant.has_conflicts ? 'border-ios-red/20' : 'border-ios-gray-200'\r\n                              }`}\r\n                            >\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                {applicant.profile_image ? (\r\n                                  <img\r\n                                    src={`/uploads/profiles/${applicant.profile_image}`}\r\n                                    alt={applicant.staff_name}\r\n                                    className=\"h-8 w-8 rounded-full object-cover\"\r\n                                  />\r\n                                ) : (\r\n                                  <div className=\"h-8 w-8 rounded-full bg-ios-gray-200 flex items-center justify-center\">\r\n                                    <UserIcon className=\"h-4 w-4 text-ios-gray-500\" />\r\n                                  </div>\r\n                                )}\r\n                                <div>\r\n                                  <p className=\"font-medium text-ios-gray-900 flex items-center\">\r\n                                    {applicant.staff_name}\r\n                                    {applicant.fully_qualified && (\r\n                                      <CheckCircleIcon className=\"h-4 w-4 text-ios-green ml-2\" title=\"Voll qualifiziert\" />\r\n                                    )}\r\n                                    {applicant.has_conflicts && (\r\n                                      <ExclamationTriangleIcon className=\"h-4 w-4 text-ios-red ml-2\" title=\"Hat Zeitkonflikte\" />\r\n                                    )}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-ios-gray-500\">\r\n                                    {applicant.qualifications || 'Keine Qualifikationen'}\r\n                                  </p>\r\n                                  {applicant.qualification_match && !applicant.fully_qualified && (\r\n                                    <p className=\"text-xs text-ios-orange mt-1\">\r\n                                      {applicant.qualification_match.has} von {applicant.qualification_match.required} Qualifikationen\r\n                                    </p>\r\n                                  )}\r\n                                  {applicant.has_conflicts && (\r\n                                    <p className=\"text-xs text-ios-red mt-1\">\r\n                                      Konflikt mit: {applicant.conflicts.map(c => c.shift_name).join(', ')}\r\n                                    </p>\r\n                                  )}\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <button\r\n                                  onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    handleAssignStaff(shift.id, applicant.staff_id, shift.position_id);\r\n                                  }}\r\n                                  disabled={applicant.has_conflicts}\r\n                                  className={`ios-button-primary text-sm px-3 py-1 ${\r\n                                    applicant.has_conflicts ? 'opacity-50 cursor-not-allowed' : ''\r\n                                  }`}\r\n                                >\r\n                                  Einteilen\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Actions */}\r\n                    <div className=\"p-4 bg-ios-gray-50 flex items-center justify-between\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        {shift.assignments.filter(a => a.status === 'preliminary').length > 0 && (\r\n                          <span className=\"text-sm text-ios-orange\">\r\n                            <ExclamationTriangleIcon className=\"inline h-4 w-4 mr-1\" />\r\n                            {shift.assignments.filter(a => a.status === 'preliminary').length} vorläufig\r\n                          </span>\r\n                        )}\r\n                        {shift.assignments.filter(a => a.status === 'final').length > 0 && (\r\n                          <span className=\"text-sm text-ios-blue\">\r\n                            <EnvelopeIcon className=\"inline h-4 w-4 mr-1\" />\r\n                            {shift.assignments.filter(a => a.status === 'final').length} endgültig\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setSelectedShiftForAssignment(shift.id);\r\n                          }}\r\n                          className=\"ios-button-secondary text-sm\"\r\n                        >\r\n                          <PlusIcon className=\"h-4 w-4 mr-1\" />\r\n                          Mitarbeiter zuweisen\r\n                        </button>\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setStatusAction({ type: 'shift', shiftId: shift.id });\r\n                            setShowStatusDialog(true);\r\n                          }}\r\n                          className=\"ios-button-secondary text-sm\"\r\n                        >\r\n                          Status ändern\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Available Staff Column */}\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-ios-gray-900\">Verfügbare Mitarbeiter</h2>\r\n            <span className=\"text-sm text-ios-gray-500\">{filteredAvailableStaff.length} verfügbar</span>\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <div className=\"ios-card p-4 space-y-3\">\r\n            <h3 className=\"text-sm font-medium text-ios-gray-700 flex items-center\">\r\n              <FunnelIcon className=\"h-4 w-4 mr-2\" />\r\n              Filter\r\n            </h3>\r\n            \r\n            {/* Qualification Filter */}\r\n            <div>\r\n              <label className=\"block text-xs text-ios-gray-600 mb-1\">Qualifikation</label>\r\n              <select\r\n                value={filterQualification}\r\n                onChange={(e) => setFilterQualification(e.target.value)}\r\n                className=\"ios-input w-full text-sm\"\r\n              >\r\n                <option value=\"\">Alle Qualifikationen</option>\r\n                {qualifications.map(qual => (\r\n                  <option key={qual.id} value={qual.name}>{qual.name}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            \r\n            {/* Checkboxes */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={filterFullyQualified}\r\n                  onChange={(e) => setFilterFullyQualified(e.target.checked)}\r\n                  className=\"rounded text-ios-blue focus:ring-ios-blue mr-2\"\r\n                />\r\n                <span className=\"text-sm text-ios-gray-700\">Nur voll qualifizierte</span>\r\n              </label>\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={filterNoConflicts}\r\n                  onChange={(e) => setFilterNoConflicts(e.target.checked)}\r\n                  className=\"rounded text-ios-blue focus:ring-ios-blue mr-2\"\r\n                />\r\n                <span className=\"text-sm text-ios-gray-700\">Ohne Zeitkonflikte</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Staff List */}\r\n          <div className=\"ios-card p-4 max-h-[calc(100vh-400px)] overflow-y-auto\">\r\n            {selectedShiftForAssignment && (\r\n              <div className=\"mb-3 p-3 bg-ios-blue/10 rounded-xl\">\r\n                <p className=\"text-sm font-medium text-ios-blue\">\r\n                  Mitarbeiter für \"{shiftPlan.shifts.find(s => s.id === selectedShiftForAssignment)?.name}\" auswählen\r\n                </p>\r\n              </div>\r\n            )}\r\n            \r\n            {filteredAvailableStaff.length > 0 ? (\r\n              <div className=\"space-y-2\">\r\n                {filteredAvailableStaff.map((staff) => {\r\n                  // Check if staff is already assigned to any shift\r\n                  const isAssigned = shiftPlan.shifts.some(shift => \r\n                    shift.assignments.some(a => a.staff_id === staff.id)\r\n                  );\r\n                  \r\n                  // Get qualification match for selected shift\r\n                  let qualificationMatch = null;\r\n                  if (selectedShiftForAssignment) {\r\n                    const shift = shiftPlan.shifts.find(s => s.id === selectedShiftForAssignment);\r\n                    const applicant = shift?.applications?.find(a => a.staff_id === staff.id);\r\n                    qualificationMatch = applicant?.qualification_match;\r\n                  }\r\n                  \r\n                  return (\r\n                    <div\r\n                      key={staff.id}\r\n                      className={`p-3 rounded-xl border ${\r\n                        isAssigned \r\n                          ? 'border-ios-gray-200 bg-ios-gray-50 opacity-50' \r\n                          : 'border-ios-gray-200 hover:border-ios-gray-300 cursor-pointer'\r\n                      }`}\r\n                      onClick={() => {\r\n                        if (!isAssigned && selectedShiftForAssignment) {\r\n                          handleAssignStaff(selectedShiftForAssignment, staff.id);\r\n                        }\r\n                      }}\r\n                      draggable={!isAssigned}\r\n                      onDragStart={(e) => {\r\n                        e.dataTransfer.setData('staffId', staff.id.toString());\r\n                      }}\r\n                    >\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        {staff.profile_image ? (\r\n                          <img\r\n                            src={`/uploads/profiles/${staff.profile_image}`}\r\n                            alt={staff.name}\r\n                            className=\"h-10 w-10 rounded-full object-cover\"\r\n                          />\r\n                        ) : (\r\n                          <div className=\"h-10 w-10 rounded-full bg-ios-gray-200 flex items-center justify-center\">\r\n                            <UserIcon className=\"h-5 w-5 text-ios-gray-500\" />\r\n                          </div>\r\n                        )}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"font-medium text-ios-gray-900 truncate flex items-center\">\r\n                            {staff.name}\r\n                            {isAssigned && (\r\n                              <CheckCircleIcon className=\"h-4 w-4 text-ios-green ml-2 flex-shrink-0\" title=\"Bereits eingeteilt\" />\r\n                            )}\r\n                          </p>\r\n                          <p className=\"text-xs text-ios-gray-500 truncate\">\r\n                            {staff.personal_code} • {staff.qualifications || 'Keine'}\r\n                          </p>\r\n                          {qualificationMatch && !qualificationMatch.hasAll && (\r\n                            <p className=\"text-xs text-ios-orange mt-1\">\r\n                              {qualificationMatch.has} von {qualificationMatch.required} Qualifikationen\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setShowStaffDetails(staff);\r\n                          }}\r\n                          className=\"p-1 hover:bg-ios-gray-100 rounded\"\r\n                        >\r\n                          <InformationCircleIcon className=\"h-5 w-5 text-ios-gray-400\" />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-center text-ios-gray-500 py-4\">\r\n                Keine verfügbaren Mitarbeiter mit den gewählten Filtern\r\n              </p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Quick Assignment Info */}\r\n          <div className=\"ios-card p-4\">\r\n            <h3 className=\"text-sm font-medium text-ios-gray-700 mb-3\">Schnellzuweisung</h3>\r\n            <p className=\"text-xs text-ios-gray-500 mb-3\">\r\n              Klicken Sie auf einen Mitarbeiter oder ziehen Sie ihn auf eine Schicht\r\n            </p>\r\n            \r\n            {shiftPlan.shifts.map((shift) => (\r\n              <div \r\n                key={shift.id}\r\n                className={`mb-3 p-3 border-2 border-dashed rounded-xl transition-colors ${\r\n                  selectedShiftForAssignment === shift.id \r\n                    ? 'border-ios-blue bg-ios-blue/5' \r\n                    : 'border-ios-gray-300 hover:border-ios-blue'\r\n                }`}\r\n                onClick={() => setSelectedShiftForAssignment(shift.id)}\r\n                onDragOver={(e) => e.preventDefault()}\r\n                onDrop={(e) => {\r\n                  e.preventDefault();\r\n                  const staffId = parseInt(e.dataTransfer.getData('staffId'));\r\n                  handleAssignStaff(shift.id, staffId);\r\n                }}\r\n              >\r\n                <p className=\"text-sm font-medium text-ios-gray-700\">{shift.name}</p>\r\n                <p className=\"text-xs text-ios-gray-500 mt-1\">\r\n                  {shift.coverage.assigned}/{shift.required_staff} besetzt\r\n                  {shift.required_qualifications && (\r\n                    <span className=\"block mt-1\">\r\n                      Benötigt: {shift.required_qualifications}\r\n                    </span>\r\n                  )}\r\n                </p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Change Dialog */}\r\n      {showStatusDialog && (\r\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n          <div className=\"flex min-h-full items-center justify-center p-4\">\r\n            <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm\" onClick={() => setShowStatusDialog(false)} />\r\n            \r\n            <div className=\"relative bg-white rounded-2xl shadow-xl max-w-md w-full p-6\">\r\n              <h3 className=\"text-lg font-semibold text-ios-gray-900 mb-4\">\r\n                Schichtstatus ändern\r\n              </h3>\r\n              \r\n              <p className=\"text-sm text-ios-gray-600 mb-6\">\r\n                Wählen Sie den neuen Status für {statusAction.type === 'all' ? 'alle Schichten' : 'diese Schicht'}:\r\n              </p>\r\n              \r\n              <div className=\"space-y-3 mb-6\">\r\n                <button\r\n                  onClick={() => handleStatusChange(statusAction.shiftId, 'preliminary')}\r\n                  className=\"w-full p-4 rounded-xl border-2 border-ios-orange hover:bg-ios-orange/10 transition-colors text-left\"\r\n                >\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <ExclamationTriangleIcon className=\"h-6 w-6 text-ios-orange\" />\r\n                    <div>\r\n                      <p className=\"font-medium text-ios-gray-900\">Vorläufig</p>\r\n                      <p className=\"text-xs text-ios-gray-500\">Mitarbeiter können noch nicht bestätigen</p>\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={() => handleStatusChange(statusAction.shiftId, 'final')}\r\n                  className=\"w-full p-4 rounded-xl border-2 border-ios-blue hover:bg-ios-blue/10 transition-colors text-left\"\r\n                >\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <CheckCircleIcon className=\"h-6 w-6 text-ios-blue\" />\r\n                    <div>\r\n                      <p className=\"font-medium text-ios-gray-900\">Endgültig</p>\r\n                      <p className=\"text-xs text-ios-gray-500\">Mitarbeiter werden benachrichtigt und können bestätigen</p>\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => {\r\n                  setShowStatusDialog(false);\r\n                  setStatusAction({ type: '', shiftId: null });\r\n                }}\r\n                className=\"w-full ios-button-secondary\"\r\n              >\r\n                Abbrechen\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Staff Details Modal */}\r\n      {showStaffDetails && (\r\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n          <div className=\"flex min-h-full items-center justify-center p-4\">\r\n            <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm\" onClick={() => setShowStaffDetails(null)} />\r\n            \r\n            <div className=\"relative bg-white rounded-2xl shadow-xl max-w-md w-full p-6\">\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <h3 className=\"text-lg font-semibold text-ios-gray-900\">\r\n                  Mitarbeiter-Details\r\n                </h3>\r\n                <button\r\n                  onClick={() => setShowStaffDetails(null)}\r\n                  className=\"p-1 rounded-lg hover:bg-ios-gray-100\"\r\n                >\r\n                  <XCircleIcon className=\"h-5 w-5 text-ios-gray-600\" />\r\n                </button>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  {showStaffDetails.profile_image ? (\r\n                    <img\r\n                      src={`/uploads/profiles/${showStaffDetails.profile_image}`}\r\n                      alt={showStaffDetails.name}\r\n                      className=\"h-16 w-16 rounded-full object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"h-16 w-16 rounded-full bg-ios-gray-200 flex items-center justify-center\">\r\n                      <UserIcon className=\"h-8 w-8 text-ios-gray-500\" />\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <p className=\"font-semibold text-ios-gray-900\">{showStaffDetails.name}</p>\r\n                    <p className=\"text-sm text-ios-gray-500\">{showStaffDetails.personal_code}</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                {showStaffDetails.qualifications && (\r\n                  <div>\r\n                    <p className=\"text-sm font-medium text-ios-gray-700 mb-2\">Qualifikationen</p>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {showStaffDetails.qualifications.split(', ').map((qual, idx) => (\r\n                        <span\r\n                          key={idx}\r\n                          className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${getQualificationBadge(qual)}`}\r\n                        >\r\n                          {qual}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                <div>\r\n                  <p className=\"text-sm font-medium text-ios-gray-700 mb-2\">Schicht-Kompatibilität</p>\r\n                  <div className=\"space-y-2\">\r\n                    {shiftPlan.shifts.map(shift => {\r\n                      const applicant = shift.applications?.find(a => a.staff_id === showStaffDetails.id);\r\n                      const hasApplied = !!applicant;\r\n                      const isQualified = applicant?.fully_qualified;\r\n                      const hasConflicts = applicant?.has_conflicts;\r\n                      \r\n                      return (\r\n                        <div key={shift.id} className=\"flex items-center justify-between p-2 bg-ios-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-ios-gray-700\">{shift.name}</span>\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            {hasApplied && (\r\n                              <span className=\"text-xs text-ios-purple\">Beworben</span>\r\n                            )}\r\n                            {isQualified ? (\r\n                              <CheckCircleIcon className=\"h-4 w-4 text-ios-green\" title=\"Qualifiziert\" />\r\n                            ) : shift.required_qualifications && (\r\n                              <XCircleIcon className=\"h-4 w-4 text-ios-gray-400\" title=\"Nicht qualifiziert\" />\r\n                            )}\r\n                            {hasConflicts && (\r\n                              <ShieldExclamationIcon className=\"h-4 w-4 text-ios-red\" title=\"Zeitkonflikt\" />\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"mt-6\">\r\n                <button\r\n                  onClick={() => setShowStaffDetails(null)}\r\n                  className=\"w-full ios-button-secondary\"\r\n                >\r\n                  Schließen\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShiftPlanning;\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}